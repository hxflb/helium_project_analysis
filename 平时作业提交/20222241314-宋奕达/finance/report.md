## 模型训练报告文档

**1. 项目概述**

本项目的目标是训练一个文本分类模型，用于预测产品的类别。该模型使用逻辑回归算法，并结合TF-IDF特征提取方法。
**Train_model.py训练模型**
**class_final_test.py输出结果**

**2. 数据预处理**

* **数据加载和清洗:** 从`combined_file.csv`文件中加载数据，并清理列名中的空格。
* **文本预处理:** 使用正则表达式去除文本中的非字母数字字符，并将文本转换为小写。
* **缺失值处理:** 检查并移除标签列中的缺失值（NaN）。
* **类别样本数量检查:** 确保每个类别至少有两个样本，以避免训练问题.

**3. 特征工程**

* **TF-IDF向量化:** 使用`TfidfVectorizer`将文本数据转换为数值特征向量。为了控制特征空间大小和捕捉词组信息，设置了`max_features=10000`，`min_df=2`，`max_df=0.99`，`ngram_range=(1, 2)`。

**4. 模型训练**

* **数据集划分:** 使用`train_test_split`将数据集划分为训练集和测试集，比例为8:2，并设置`random_state=42`以确保结果可复现。
* **模型选择:** 选择逻辑回归模型（`LogisticRegression`），并设置`class_weight='balanced'`以处理类别不平衡问题，`random_state=42`确保结果可复现，`max_iter=1000`确保模型能够收敛.
* **模型训练:** 使用训练集数据训练逻辑回归模型。
* **模型保存:** 使用`joblib`保存训练好的模型和向量化器，以便后续使用。

**5. 模型评估**

* **准确率:** 使用`accuracy_score`计算模型在测试集上的准确率。
* **分类报告:** 使用`classification_report`生成更详细的分类报告，包括精确率、召回率、F1值等指标，并设置`zero_division=1`以处理可能出现的零除错误。
* **交叉验证:** 使用`StratifiedKFold`进行5折分层交叉验证，并使用`f1_weighted`作为评分指标，以评估模型的泛化能力.  减少了折数以加快验证速度。


**6. 测试代码分析**

测试代码实现了模型预测功能，并增加了置信度阈值和标签映射功能。

* **加载模型和向量化器:** 从指定路径加载训练好的模型和向量化器。
* **数据加载和预处理:** 加载CSV文件中的英文和中文产品名称，并进行预处理，包括去除非字母字符、转换为小写等。
* **标签映射:** 加载标签映射文件，将英文标签映射到中文标签。
* **预测函数:** 使用加载的模型和向量化器对输入文本进行预测，并根据置信度阈值判断预测结果是否有效。如果预测概率低于阈值，则返回“未知”。
* **输出结果:**  输出产品的中文类别标签，并将置信度低于阈值的产品单独标记为“未知”。
* **日志记录:** 使用`logging`模块记录程序运行过程中的信息和错误，方便调试和排错。
* **错误处理:** 使用`try-except`块捕获 potential 错误，例如文件未找到、数据读取错误等。


**7. 未来改进方向**

* **特征工程:** 尝试其他特征工程方法，例如词嵌入（Word Embeddings）或更复杂的文本表示方法，以提高模型性能。
* **模型选择:** 尝试其他分类模型，例如支持向量机（SVM）、随机森林（Random Forest）等，并比较它们的性能。
* **超参数调优:** 使用网格搜索或贝叶斯优化等方法对模型超参数进行调优，以找到最佳的模型配置.
* **数据增强:** 如果数据集规模较小，可以考虑使用数据增强技术来扩充训练数据，例如同义词替换、回译等。


**8. 总结**

本项目成功地训练了一个基于逻辑回归的文本分类模型，用于预测产品的类别。模型评估结果表明，该模型具有一定的预测能力。但是，仍然可以通过进一步的改进提高模型的性能和鲁棒性.  测试代码提供了清晰的预测流程，并增加了置信度阈值和标签映射功能，提高了预测结果的实用性。


**9. 附录**

*  训练代码
*  测试代码
*  `combined_file.csv` 文件描述
*  `new_text.csv` 文件描述
*  `new_lable.csv` 文件描述


这个报告文档提供了更详细的解释，涵盖了数据预处理、特征工程、模型训练、模型评估以及测试代码的分析，并提出了一些改进建议。它还包含了清晰的结构和总结，使读者更容易理解项目的各个方面。